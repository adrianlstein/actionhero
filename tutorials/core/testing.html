<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Testing | actionhero</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.js" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">actionhero</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
			</ul>
			<h1> Testing</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><img src="flying-man.svg" alt=""></p>
				<a href="#overview" id="overview" style="color: inherit; text-decoration: none;">
					<h2>Overview</h2>
				</a>
				<p>ActionHero provides test helpers so that you may try your actions and tasks within a headless environment. We do this by including a <code>specHelper</code> initializer which creates a server, <code>testServer</code> when running within the test environment. Via the <code>testServer</code>, you can easily call actions or tasks without making a real request.</p>
				<p>We have chosen <a href="https://facebook.github.io/jest">jest</a> as our test framework which is included as dependencies within all new projects generated with <code>actionhero generate</code>. You do not need to use these testing tools, but an example will be provided which makes use of them.</p>
				<p>You also don&#39;t need to use these test helpers, and you may want to make a real http or websocket request to test something specific. If this is the case, you can <a href="https://github.com/actionhero/actionhero/tree/master/test/servers">check out how ActionHero tests its own servers</a> for examples.</p>
				<a href="#getting-started" id="getting-started" style="color: inherit; text-decoration: none;">
					<h2>Getting Started</h2>
				</a>
				<pre><code class="language-js"><span class="hljs-comment">// package.json from a new actionhero project with \`jest\`included</span>
{
  <span class="hljs-string">"author"</span>      : <span class="hljs-string">"YOU &lt;YOU@example.com&gt;"</span>,
  <span class="hljs-string">"name"</span>        : <span class="hljs-string">"my_actionhero_project"</span>,
  <span class="hljs-string">"description"</span> : <span class="hljs-string">"my actionhero project"</span>,
  <span class="hljs-string">"version"</span>     : <span class="hljs-string">"0.1.0"</span>,
  <span class="hljs-string">"engines"</span>     : {
    <span class="hljs-string">"node"</span>: <span class="hljs-string">"&gt;=8.0.0"</span>
  },
  <span class="hljs-string">"dependencies"</span> : {
    <span class="hljs-string">"actionhero"</span> : <span class="hljs-string">"^14.0.0"</span>,
    <span class="hljs-string">"ws"</span>         : <span class="hljs-string">"latest"</span>
  },
  <span class="hljs-string">"devDependencies"</span> : {
    <span class="hljs-string">"jest"</span> : <span class="hljs-string">"latest"</span>
  },
  <span class="hljs-string">"scripts"</span> : {
    <span class="hljs-string">"help"</span>         : <span class="hljs-string">"actionhero help"</span>,
    <span class="hljs-string">"start"</span>        : <span class="hljs-string">"actionhero start"</span>,
    <span class="hljs-string">"actionhero"</span>   : <span class="hljs-string">"actionhero"</span>,
    <span class="hljs-string">"start cluster"</span>: <span class="hljs-string">"actionhero start cluster"</span>,
    <span class="hljs-string">"test"</span>         : <span class="hljs-string">"jest"</span>
  }
}</code></pre>
				<p>To run a jest test suite, you invoke the jest binary, <code>./node_modules/.bin/jest</code> or <code>npx jest</code>. This will tell jest to look in your <code>./__tests__</code> folder and run any tests that it can find. There are ways to change the test folder location, only run specific tests, change the reporting format and more which you can learn about on <a href="https://facebook.github.io/jest">Jest&#39;s website</a>. We assume that you have <code>jest</code> installed to your project by listing it in your <code>package.json</code>. If you used <code>actionHero generate</code> to create your project, this should already be configured for you.</p>
				<p>The majority of the time, you&#39;ll be testing actions and other methods you have written, so you&#39;ll need to &quot;run&quot; an actionhero server as part of your test suite. Many times you&#39;ll want to have ActionHero behave in a slightly unique way while testing (perhaps connect to a special database, don&#39;t log, etc). To do this, you can change the behavior of the config files for the <code>test</code> environment. Here is how we tell ActionHero <a href="https://github.com/actionhero/actionhero/blob/master/config/logger.js#L48-L54">not to write any logs when testing</a>. Note the test-specific configuration overrides the defaults. Jest will automatically set <code>NODE_ENV=test</code> for you.</p>
				<p>ActionHero comes with a <code>specHelper</code> to make it easier to test tasks and actions. This specHelper is a special <a href="/docs/core/#servers">server</a> which can check things without needing to make an HTTP, websocket, etc request. If you need to check the true behavior of a server (perhaps how the router works for an HTTP request), you should make a real HTTP request in your test suite, using something like the <a href="https://github.com/request/request">request</a> library (<a href="https://github.com/actionhero/actionhero/blob/master/test/servers/web.js#L178-L184">example</a>).</p>
				<a href="#example-test" id="example-test" style="color: inherit; text-decoration: none;">
					<h2>Example Test</h2>
				</a>
				<p>Say you had an action that was supposed to respond with a <code>randomNumber</code>, and you wanted to write a test for it.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> ActionHero = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)
<span class="hljs-keyword">const</span> actionhero = <span class="hljs-keyword">new</span> ActionHero.Process()
<span class="hljs-keyword">let</span> api

describe(<span class="hljs-string">'Action'</span>, () =&gt; {
  describe(<span class="hljs-string">'randomNumber'</span>, () =&gt; {
    beforeAll(<span class="hljs-keyword">async</span> () =&gt; { api = <span class="hljs-keyword">await</span> actionhero.start() })
    afterAll(<span class="hljs-keyword">async</span> () =&gt; { <span class="hljs-keyword">await</span> actionhero.stop() })

    <span class="hljs-keyword">let</span> firstNumber = <span class="hljs-literal">null</span>

    test(<span class="hljs-string">'generates random numbers'</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> {randomNumber} = <span class="hljs-keyword">await</span> api.specHelper.runAction(<span class="hljs-string">'randomNumber'</span>)
      expect(randomNumber).toBeGreaterThan(<span class="hljs-number">0</span>)
      expect(randomNumber).toBeLessThan(<span class="hljs-number">1</span>)
      firstNumber = randomNumber
    })

    test(<span class="hljs-string">'is unique'</span>, <span class="hljs-keyword">async</span> () =&gt; {
      <span class="hljs-keyword">const</span> {randomNumber} = <span class="hljs-keyword">await</span> api.specHelper.runAction(<span class="hljs-string">'randomNumber'</span>)
      expect(randomNumber).toBeGreaterThan(<span class="hljs-number">0</span>)
      expect(randomNumber).toBeLessThan(<span class="hljs-number">1</span>)
      expect(randomNumber).not.toEqual(firstNumber)
    })
  })
})
</code></pre>
				<p>More details on the specHelper methods <a href="api.specHelper.html">can be found here</a></p>
				<p>If you want to see fuller example of how to create an integration test within ActionHero, please <a href="https://github.com/actionhero/actionhero-tutorial#testing">check out the tutorial</a></p>
				<a href="#notes" id="notes" style="color: inherit; text-decoration: none;">
					<h2>Notes</h2>
				</a>
				<p>If you do not want the <code>specHelper</code> actions to include metadata (<code>data.response.serverInformation</code>, <code>data.response.requesterInformation</code>, and <code>data.response.messageId</code>) from the server, you can configure <code>api.specHelper.returnMetadata = false</code> in your tests.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="../../globals.html"><em>Globals</em></a>
					</li>
					<li class="current ">
						<a href="../index.html">Tutorial index</a>
						<ul>
							<li class="current ">
								<a href="index.html">Actionhero <wbr>Core <wbr>Features</a>
								<ul>
									<li class=" ">
										<a href="actions.html">Actions</a>
									</li>
									<li class=" ">
										<a href="tasks.html">Tasks</a>
									</li>
									<li class=" ">
										<a href="initializers.html">Initializers</a>
									</li>
									<li class=" ">
										<a href="localization.html">Localization</a>
									</li>
									<li class=" ">
										<a href="middleware.html">Middleware</a>
									</li>
									<li class="current ">
										<a href="testing.html">Testing</a>
									</li>
									<li class=" ">
										<a href="chat.html">Chat</a>
									</li>
									<li class=" ">
										<a href="servers/index.html">Servers</a>
									</li>
									<li class=" ">
										<a href="cli.html">Cli</a>
									</li>
								</ul>
							</li>
							<li class=" ">
								<a href="../config-and-dev/index.html">Configuration and <wbr>Development</a>
							</li>
							<li class=" ">
								<a href="../advanced/index.html">Advanced <wbr>Actionhero <wbr>Topics</a>
							</li>
						</ul>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.js"><' + '/script>');</script>
</body>
</html>