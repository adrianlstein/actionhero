<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Localization | actionhero</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.js" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">actionhero</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
			</ul>
			<h1> Localization</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><img src="localization.svg" alt=""></p>
				<a href="#overview" id="overview" style="color: inherit; text-decoration: none;">
					<h2>Overview</h2>
				</a>
				<p>ActionHero uses the <a href="https://github.com/mashpie/i18n-node">i18n</a> module to localize responses to clients.</p>
				<a href="#locale-files" id="locale-files" style="color: inherit; text-decoration: none;">
					<h2>Locale Files</h2>
				</a>
				<ul>
					<li>When running ActionHero with <code>api.config.i18n.updateFiles = true</code>, you will see ActionHero generate a &#39;locales&#39; folder at the top level of your project which will contain translations of all strings in your project with are passed though the new localization system. This includes all uses of <code>api.i18n.localize</code> and <code>connection.localize</code>.<ul>
							<li>We use mustache-style localization</li>
						</ul>
					</li>
					<li>From here, it is an easy matter to change the strings, per locale, to how you would like them presented back in your application. The next time you restart the server, the values you&#39;ve updated in your locale strings file will be used.</li>
					<li>disable <code>api.config.i18n.updateFiles</code> if you do not want this behavior.</li>
				</ul>
				<a href="#connection-locale" id="connection-locale" style="color: inherit; text-decoration: none;">
					<h2>Connection Locale</h2>
				</a>
				<p>Since every ActionHero implementation is unique, we do not ship with a &quot;guess&quot; about how to determine a given connection&#39;s locale. Perhaps you have an HTTP server and you can trust your client&#39;s <code>accept-language</code> headers. Or perhaps you run your API under a number of different host names and you can presume locale based on them. Whatever the case, you need to create a async method in an initializer which will be called when each connection connects to return its locale.</p>
				<p>For example, I may have an initializer in my project like this:</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> {Initializer} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)

<span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DetermineConnectionLocale</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Initializer</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'determineConnectionLocale'</span>
  }

  initialize () {
    api.customLocalization = {
      <span class="hljs-attr">lookup</span>: <span class="hljs-function">(<span class="hljs-params">connection</span>) =&gt;</span> {
        <span class="hljs-keyword">let</span> locale = <span class="hljs-string">'en'</span>;

        <span class="hljs-keyword">if</span>(connection.type === <span class="hljs-string">'web'</span>){
          <span class="hljs-keyword">const</span> host = connection.rawConnection.req.headers.host
          <span class="hljs-keyword">if</span>(host === <span class="hljs-string">'usa.site.com'</span>){ locale = <span class="hljs-string">'en-US'</span>; }
          <span class="hljs-keyword">if</span>(host === <span class="hljs-string">'uk.site.com'</span>){  locale = <span class="hljs-string">'en-GB'</span>; }
          <span class="hljs-keyword">if</span>(host === <span class="hljs-string">'es.site.com'</span>){  locale = <span class="hljs-string">'es-ES'</span>; }
          <span class="hljs-keyword">if</span>(host === <span class="hljs-string">'mx.site.com'</span>){  locale = <span class="hljs-string">'es-MX'</span>; }
        }

        <span class="hljs-keyword">return</span> locale
      }
    }
  }
}</code></pre>
				<p>To tell i18n to use this method with a new connection, set <code>api.config.i18n.determineConnectionLocale = &#39;api.customLocalization.lookup&#39;</code>.  Now you can localize responses in actions, based on which hostname a connection uses.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> {Action} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)

<span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">RandomNumber</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'randomNumber'</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I am an API method which will generate a random number, returning both the number and a localized string'</span>
    <span class="hljs-keyword">this</span>.outputExample = {
      <span class="hljs-attr">number</span>: <span class="hljs-number">0.234</span>,
      <span class="hljs-attr">localizedResponse</span>: <span class="hljs-string">'Your random number is 0.234'</span>
    }
  }

  <span class="hljs-keyword">async</span> run ({connection, response}) {
    <span class="hljs-keyword">const</span> number = <span class="hljs-built_in">Math</span>.random()
    <span class="hljs-keyword">const</span> localizedResponse = connection.localize([<span class="hljs-string">'Your random number is {{number}}'</span>, {<span class="hljs-attr">number</span>: number}])
    response.message = localizedResponse
    response.number = number
  }
}</code></pre>
				<a href="#connection-methods" id="connection-methods" style="color: inherit; text-decoration: none;">
					<h2>Connection Methods</h2>
				</a>
				<ul>
					<li><code>connection.localize(string)</code> or <code>connection.localize([string-with-interpolation, values])</code><ul>
							<li>Allows you to interpolate a string based on the connection&#39;s current locale. For example, say in an action you wanted to respond with <code>{CountExample}</code> In your locale files, you would define <code>the count was {{count}}</code> in every language you cared about, and not need to modify the action itself at all.</li>
						</ul>
					</li>
				</ul>
				<a href="#other-strings" id="other-strings" style="color: inherit; text-decoration: none;">
					<h2>Other Strings</h2>
				</a>
				<ul>
					<li>To localize strings that are not used in methods mentioned above you can use <code>api.i18n.localize(string, options)</code>.<ul>
							<li>Allows you to interpolate a string.</li>
							<li>Just as the other localize methods above, the input string will be in your locale files for you to change it anytime you want.</li>
							<li>The second <code>options</code> optional argument (default value is <code>api.i18n</code>) allows you to <a href="https://github.com/mashpie/i18n-node#list-of-all-configuration-options">configure</a> i18n. Note that you will use this argument only in very few special cases, It is recommended to edit the global <code>api.config.i18n</code> settings to suit your localization needs.</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="../../globals.html"><em>Globals</em></a>
					</li>
					<li class="current ">
						<a href="../index.html">Tutorial index</a>
						<ul>
							<li class="current ">
								<a href="index.html">Actionhero <wbr>Core <wbr>Features</a>
								<ul>
									<li class=" ">
										<a href="actions.html">Actions</a>
									</li>
									<li class=" ">
										<a href="tasks.html">Tasks</a>
									</li>
									<li class=" ">
										<a href="initializers.html">Initializers</a>
									</li>
									<li class="current ">
										<a href="localization.html">Localization</a>
									</li>
									<li class=" ">
										<a href="middleware.html">Middleware</a>
									</li>
									<li class=" ">
										<a href="testing.html">Testing</a>
									</li>
									<li class=" ">
										<a href="chat.html">Chat</a>
									</li>
									<li class=" ">
										<a href="servers/index.html">Servers</a>
									</li>
									<li class=" ">
										<a href="cli.html">Cli</a>
									</li>
								</ul>
							</li>
							<li class=" ">
								<a href="../config-and-dev/index.html">Configuration and <wbr>Development</a>
							</li>
							<li class=" ">
								<a href="../advanced/index.html">Advanced <wbr>Actionhero <wbr>Topics</a>
							</li>
						</ul>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.js"><' + '/script>');</script>
</body>
</html>