<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Actions | actionhero</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="../../assets/css/main.css">
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="../../assets/js/search.js" data-base="../..">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="../../index.html" class="title">actionhero</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
							<input type="checkbox" id="tsd-filter-only-exported" />
							<label class="tsd-widget" for="tsd-filter-only-exported">Only exported</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<ul class="tsd-breadcrumb">
			</ul>
			<h1> Actions</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<p><img src="easy-to-use-actions.svg" alt=""></p>
				<a href="#overview" id="overview" style="color: inherit; text-decoration: none;">
					<h2>Overview</h2>
				</a>
				<pre><code class="language-js"><span class="hljs-comment">// A simple Action</span>

<span class="hljs-keyword">const</span> {Action, api} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)

<span class="hljs-built_in">module</span>.exports = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MyAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
 <span class="hljs-keyword">constructor</span> () {
   <span class="hljs-keyword">super</span>()
   <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'randomNumber'</span>
   <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I am an API method which will generate a random number'</span>
   <span class="hljs-keyword">this</span>.outputExample = {<span class="hljs-attr">randomNumber</span>: <span class="hljs-number">0.1234</span>}
 }

 <span class="hljs-keyword">async</span> run (data) {
   data.response.randomNumber = <span class="hljs-built_in">Math</span>.random()
 }
}</code></pre>
				<p>The core of ActionHero is the Action framework, and <strong>actions</strong> are the basic units of work.  All connection types from all servers can use actions.  This means that you only need to write an action once, and both HTTP clients and websocket clients can consume it.</p>
				<p>The goal of an action is to read <code>data.params</code> (which are the arguments a connection provides), do work, and set the <code>data.response</code> (and <code>data.response.error</code> when needed) values to build the response to the client.</p>
				<p>You can create you own actions by placing them in a <code>./actions/</code> folder at the root of your application.  You can use the generator with <code>actionhero generate action --name=myAction</code></p>
				<p>You can also define more than one action per file if you would like, and extend classes to share common methods and components (like input parsers).</p>
				<pre><code class="language-js"><span class="hljs-comment">// Compound Action with Shared Inputs//</span>
<span class="hljs-keyword">const</span> {Action} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidatedAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.inputs = {
      <span class="hljs-attr">email</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-keyword">this</span>.emailValidator
      },
      <span class="hljs-attr">password</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-keyword">this</span>.passwordValidator
      }
    }
  }

  emailValidator (param) {
    <span class="hljs-keyword">if</span> (param.indexOf(<span class="hljs-string">'@'</span>) &lt; <span class="hljs-number">0</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'that is not a valid email address'</span>)
    }
  }

  passwordValidator (param) {
    <span class="hljs-keyword">if</span> (param.length &lt; <span class="hljs-number">4</span>) {
      <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'password should be at least 3 letters long'</span>)
    }
  }
}

<span class="hljs-comment">// the actions</span>
exports.UserAdd = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserAdd</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ValidatedAction</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'userAdd'</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I add a user'</span>
  }

  run (data) {
    <span class="hljs-comment">// your code here</span>
  }
}

exports.UserDelete = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UserDelete</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">ValidatedAction</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'userDelete'</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I delete a user'</span>
  }

  run (data) {
    <span class="hljs-comment">// your code here</span>
  }
}</code></pre>
				<a href="#versions" id="versions" style="color: inherit; text-decoration: none;">
					<h2>Versions</h2>
				</a>
				<p>ActionHero supports multiple versions of the same action.  This will allow you to support actions/routes of the same name with upgraded functionality.</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> { Action } = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./../index.js'</span>)

exports.ActionVersion1 = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionVersion1</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'randomNumber'</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I am an API method which will generate a random number'</span>
    <span class="hljs-keyword">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span class="hljs-number">0.123</span> }
    <span class="hljs-keyword">this</span>.version = <span class="hljs-number">1</span>
  }

  <span class="hljs-keyword">async</span> run ({ connection, response }) {
    response.version = <span class="hljs-number">1</span>
    response.randomNumber = <span class="hljs-built_in">Math</span>.random()
  }
}

exports.ActionVersion2 = <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ActionVersion2</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'randomNumber'</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I am an API method which will generate a random number'</span>
    <span class="hljs-keyword">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span class="hljs-number">0.123</span> }
    <span class="hljs-keyword">this</span>.version = <span class="hljs-number">2</span>
  }

  <span class="hljs-keyword">async</span> run ({ connection, response }) {
    response.version = <span class="hljs-number">2</span>
    response.randomNumber = <span class="hljs-built_in">Math</span>.random()
    response.randomNumber = connection.localize([<span class="hljs-string">'Your random number is {{randomNumber}}'</span>, response])
  }
}</code></pre>
				<ul>
					<li>actions optionally have the <code>this.version</code> attribute, which defaults to <code>1</code>.</li>
					<li>a reserved param, <code>apiVersion</code> is used to directly specify the version of an action a client may request.</li>
					<li>if a client doesn&#39;t specify an <code>apiVersion</code>, they will be directed to the highest numerical version of that action.</li>
				</ul>
				<p>You can optionally create routes to handle your API versioning:</p>
				<p><em>As a note, if a client accessing ActionHero via routes does not provide an apiVersion and it is explicitly defined in the route, the highest number will not be assigned automatically, and will be seen as a routing error.</em></p>
				<pre><code class="language-js">exports.routes = {
  <span class="hljs-attr">all</span>: [
    <span class="hljs-comment">// creates routes like \`/api/myAction/1/\` and \`/api/myAction/2/\`</span>
    <span class="hljs-comment">// will also default \`/api/myAction\` to the latest version</span>
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'/myAction/:apiVersion'</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">'myAction'</span> },

    <span class="hljs-comment">// creates routes like \`/api/1/myAction/\` and \`/api/2/myAction/\`</span>
    <span class="hljs-comment">// will also default \`/api/myAction\` to the latest version</span>
    { <span class="hljs-attr">path</span>: <span class="hljs-string">'/:apiVersion/myAction'</span>, <span class="hljs-attr">action</span>: <span class="hljs-string">'myAction'</span> },
  ]
};</code></pre>
				<p>We go into more detail about routes when discussing the <a href="tutorial-web-server.html">web server</a></p>
				<a href="#options" id="options" style="color: inherit; text-decoration: none;">
					<h2>Options</h2>
				</a>
				<p>The complete set of options an action can have are:</p>
				<pre><code class="language-js"><span class="hljs-keyword">const</span> {Action, api} = <span class="hljs-built_in">require</span>(<span class="hljs-string">'actionhero'</span>)

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ValidatedAction</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Action</span> </span>{
  <span class="hljs-keyword">constructor</span> () {
    <span class="hljs-keyword">super</span>()

    <span class="hljs-comment">// (required) the action's name (the \`exports\` key doesn't matter)</span>
    <span class="hljs-keyword">this</span>.name = <span class="hljs-string">'randomNumber'</span>

    <span class="hljs-comment">// (required) the description</span>
    <span class="hljs-keyword">this</span>.description = <span class="hljs-string">'I am an API method which will generate a random number'</span>

    <span class="hljs-comment">// (required) a hash of all the inputs this action will accept</span>
    <span class="hljs-comment">// any inputs provided to the action not in this hash will be stripped</span>
    <span class="hljs-keyword">this</span>.inputs = {
      <span class="hljs-attr">multiplier</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (param &lt; <span class="hljs-number">0</span>) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'must be &gt; 0'</span>) }
        },
        <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(param)
        },
        <span class="hljs-attr">default</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>
        },
      }
    },

    <span class="hljs-comment">// any middlewares to apply before/after this action</span>
    <span class="hljs-comment">// global middleware will be applied automatically</span>
    <span class="hljs-comment">// default []</span>
    <span class="hljs-keyword">this</span>.middleware = []

    <span class="hljs-comment">// an example response</span>
    <span class="hljs-comment">// default: {}</span>
    <span class="hljs-keyword">this</span>.outputExample = { <span class="hljs-attr">randomNumber</span>: <span class="hljs-number">123</span> }

    <span class="hljs-comment">// you can choose to block certain servers from using this action</span>
    <span class="hljs-comment">// default: []</span>
    <span class="hljs-keyword">this</span>.blockedConnectionTypes = [<span class="hljs-string">'webSocket'</span>]

    <span class="hljs-comment">// how should this action be logged?</span>
    <span class="hljs-comment">// default: 'info'</span>
    <span class="hljs-keyword">this</span>.logLevel = <span class="hljs-string">'warning'</span>

    <span class="hljs-comment">// (HTTP only) if the route for this action includes an extension (like .jpg), should the response MIME be adjusted to match?</span>
    <span class="hljs-comment">// default: true</span>
    <span class="hljs-keyword">this</span>.matchExtensionMimeType = <span class="hljs-literal">true</span>

    <span class="hljs-comment">// should this action appear within \`api.documentation.documentation\`</span>
    <span class="hljs-comment">// default: true</span>
    <span class="hljs-keyword">this</span>.toDocument = <span class="hljs-literal">true</span>

    <span class="hljs-comment">// (required) the run method of the action</span>
    <span class="hljs-keyword">async</span> run (data) {
      data.response.randomNumber = <span class="hljs-built_in">Math</span>.random() * data.params.multiplier;
    }
  }
}</code></pre>
				<p>Note that for many of these, you can define them as a scalar in the constructor or as a method which returns the proper response.</p>
				<a href="#inputs" id="inputs" style="color: inherit; text-decoration: none;">
					<h2>Inputs</h2>
				</a>
				<pre><code class="language-js">action.inputs = {
  <span class="hljs-comment">// a simple input</span>
  <span class="hljs-comment">// defaults assume required = false</span>
  <span class="hljs-attr">minimalInput</span>: {}

  <span class="hljs-comment">// a complex input</span>
  <span class="hljs-attr">multiplier</span>: {
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
      <span class="hljs-keyword">if</span> (param &lt; <span class="hljs-number">0</span>) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'must be &gt; 0'</span>) }
    },
    <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(param);
    },
    <span class="hljs-attr">default</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
      <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
    },
  },

  <span class="hljs-comment">// a schema input</span>
  <span class="hljs-attr">schemaInput</span>: {
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">default</span>: {},
    <span class="hljs-attr">schema</span>: {
      <span class="hljs-attr">nestedInput</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">default</span>: <span class="hljs-number">1</span>,
        <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
          <span class="hljs-keyword">if</span> (param &lt; <span class="hljs-number">0</span>) { <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'must be &gt; 0'</span>) }
        },
        <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">param, connection, actionTemplate</span>) =&gt;</span> {
          <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseInt</span>(param);
        },
      },
      <span class="hljs-attr">otherInput</span>: {},
    }
  }
};</code></pre>
				<p>The properties of an input are:</p>
				<ul>
					<li><code>required</code> (boolean)<ul>
							<li>Default: <code>false</code></li>
						</ul>
					</li>
					<li><code>formatter = function(param, connection, actionTemplate)</code><ul>
							<li>will return the new value of the param</li>
							<li>Default: The parameter is not reformatted</li>
						</ul>
					</li>
					<li><code>default = function(param, connection, actionTemplate)</code><ul>
							<li>will return the default value of the param</li>
							<li>you can also have a static assignment for <code>default</code> father than a function, ie: <code>default: 123</code></li>
							<li>Default: Parameter has no default value</li>
						</ul>
					</li>
					<li><code>validator = function(param, connection, actionTemplate)</code><ul>
							<li>should return true, null, or undefined (return nothing) if validation passed</li>
							<li>should throw an error message if validation fails which will be returned to the client</li>
							<li>Default: Parameter is always valid</li>
						</ul>
					</li>
					<li><code>schema</code> (object)<ul>
							<li>optional nested inputs definition</li>
							<li>accept <code>object</code> similar to regular input</li>
							<li>nested input also have properties: <code>required</code>, <code>formatter</code>, <code>default</code> and <code>validator</code></li>
						</ul>
					</li>
				</ul>
				<p>You can define <code>api.config.general.missingParamChecks = [null, &#39;&#39;, undefined]</code> to choose explicitly how you want un-set params to be handled in your actions.  For example, if you want to allow explicit <code>null</code> values in a JSON payload but not <code>undefined</code>, you can now opt-in to that behavior.  This is what <code>action.inputs.x.required = true</code> will check against.</p></p>
				<p>Since all properties of an input are optional, the smallest possible definition of an input is: <code>name : {}</code>.  However, you should usually specify that an input is required (or not), ie: <code>{</code>name: {required: false}<code>}</code>.</p></p>
				<p>The methods <code>default</code>, <code>formatter</code>, and <code>validator</code> have the api object set as <code>this</code> within their scopes.  This means that you can define common formatters within middleware and reference them in each action.</p></p>
				<p>The methods are applied in this order:</p></p>
				<ul>
					<li><code>default()</code></li>
					<li><code>formatter()</code></li>
					<li><code>validator()</code></li>
					<li><code>required()</code></li>
				</ul>
				<p>Here&#39;s an example...</p>
				<pre><code class="language-js">moneyInCents: {
  <span class="hljs-attr">required</span>:  <span class="hljs-literal">true</span>,
  <span class="hljs-attr">default</span>:   <span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> { <span class="hljs-keyword">return</span> <span class="hljs-number">0</span> },
  <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> { <span class="hljs-keyword">return</span> <span class="hljs-built_in">parseFloat</span>(p) },
  <span class="hljs-attr">validator</span>: <span class="hljs-function">(<span class="hljs-params">p</span>) =&gt;</span> {
    <span class="hljs-keyword">if</span>(<span class="hljs-built_in">isNaN</span>(<span class="hljs-built_in">parseFloat</span>(p)){ <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'not a number'</span>) }
    <span class="hljs-keyword">if</span>(p &lt; <span class="hljs-number">0</span>){ <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'money cannot be negative'</span>) }
  }
}</code></pre>
				<p>Formatters and Validators can also be named method names. For example, you might have an action like:</p>
				<pre><code class="language-js">inputs: {
  <span class="hljs-attr">key</span>: {
    <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
    <span class="hljs-attr">formatter</span>: <span class="hljs-string">'api.formatter.uniqueKeyName'</span>
  }
}</code></pre>
				<p>You can define <code>api.formatter.uniqueKeyName</code> elsewhere in your project.</p>
				<p>Example schema input:</p>
				<pre><code class="language-js">inputs = {
  <span class="hljs-attr">firstName</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">lastName</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span> },
  <span class="hljs-attr">username</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span> },
  <span class="hljs-attr">address</span>: {
    <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span>,
    <span class="hljs-attr">schema</span>: {
      <span class="hljs-attr">country</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">default</span>: <span class="hljs-string">'USA'</span>
      },
      <span class="hljs-attr">state</span>: { <span class="hljs-attr">required</span>: <span class="hljs-literal">false</span> },
      <span class="hljs-attr">city</span>: {
        <span class="hljs-attr">required</span>: <span class="hljs-literal">true</span>,
        <span class="hljs-attr">formatter</span>: <span class="hljs-function">(<span class="hljs-params">val</span>) =&gt;</span> \<span class="hljs-string">`City:\${val}\`,
        validator: (val) =&gt; val.length &gt; 10,
      }
    }
  }
}</span></code></pre>
				<a href="#the-data-object" id="the-data-object" style="color: inherit; text-decoration: none;">
					<h2>The Data Object</h2>
				</a>
				<p>The <code>data</code> object passed into your action captures the state of the connection at the time the action was started.  Middleware preProcessors have already fired, and input formatting and validation has occurred.  Here are the properties of the <code>data</code> object.</p>
				<pre><code class="language-js">data = {
  <span class="hljs-attr">connection</span>: connection,
  <span class="hljs-attr">action</span>: <span class="hljs-string">'randomNumber'</span>,
  <span class="hljs-attr">toProcess</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">toRender</span>: <span class="hljs-literal">true</span>,
  <span class="hljs-attr">messageId</span>: <span class="hljs-number">123</span>,
  <span class="hljs-attr">params</span>: { <span class="hljs-attr">action</span>: <span class="hljs-string">'randomNumber'</span>, <span class="hljs-attr">apiVersion</span>: <span class="hljs-number">1</span> },
  <span class="hljs-attr">actionStartTime</span>: <span class="hljs-number">123</span>,
  <span class="hljs-attr">response</span>: {},
  <span class="hljs-attr">session</span>: {}
}</code></pre>
				<p>The goal of most actions is to do work and then modify the value of <code>data.response</code>, which will eventually be sent down to the client.</p>
				<p>You can also modify properties of the connection by accessing <code>data.connection</code>, IE changing the response header for a HTTP request.</p>
				<p>If you don&#39;t want your action to respond to the client, or you have already sent data to the client (perhaps you already rendered a file to them or sent an error HTTP header), you can set <code>data.toRender = false;</code></p>
				<p>If you are certain that your action is only going to be handled by a web server, then a convenience method has been provided to you via <code>data.connection.setHeader()</code>. This function is a proxy to the <a href='https://nodejs.org/api/http.html#http_response_setheader_name_value'>Node HTTP Response setHeader</a> function and allows you to set response headers without having to drill into the <code>data.connection.rawConnection</code> object. Please be aware, the <code>data.connection.setHeader()</code> function will only be available if your action is being handled by a web server. Other server types will throw an exception. See <a href="tutorial-servers.html">Servers: Customizing the Connection</a> for more details.</p>
				<p>Similarly to the above, the web server also exposes <code>data.connection.setStatusCode()</code>, again only for actions in use by the web server.  This can be used as a helper to set the HTTP responses&#39; status code, ie: 404, 200, etc.</p>
				<p>Finally, if your action is again only for the web server, you can send a string or buffer as a file response with <code>data.connection.pipe(buffer, headers)</code>.  You will still need to set <code>data.toRender = false</code> in your action to avoid double-sending a response to the client.</p>
				<a href="#middleware" id="middleware" style="color: inherit; text-decoration: none;">
					<h2>Middleware</h2>
				</a>
				<p>You can create middlware which would apply to the connection both before and after an action.  Middleware can be either global (applied to all actions) or local, specified in each action via <code>action.middleware = []</code>.  Supply the <code>names</code> of any middleware you want to use.</p>
				<p>You can <a href="tutorial-middleware.html">learn more about middleware here</a>.</p>
				<a href="#notes" id="notes" style="color: inherit; text-decoration: none;">
					<h2>Notes</h2>
				</a>
				<ul>
					<li>Actions&#39; run method are async, and have <code>data</code> as their only argument.  Completing an action is as simple returning from the method.</li>
					<li>If you throw an error, be sure that it is a <code>new Error()</code> object, and not a string.  Thrown errors will automatically be sent to the client in <code>response.error</code>. Also, throw Errors are processed at <code>config/errors.js</code> in <code>genericError(data, error)</code>. Here you can check your error add to the response (<code>requestIds</code>, status codes, etc.)</li>
					<li>The metadata <code>outputExample</code> is used in reflexive and self-documenting actions in the API, available via the <code>documentation</code> verb (and showDocumenation action).</li>
					<li>You can limit how many actions a persistent client (websocket, tcp, etc) can have pending at once with <code>api.config.general.simultaneousActions</code></li>
					<li><code>actions.inputs</code> are used for both documentation and for building the whitelist of allowed parameters the API will accept.  Client params not included in these whitelists will be ignored for security. If you wish to disable the whitelisting you can use the flag at <code>api.config.general.disableParamScrubbing</code>. Note that <a href="tutorial-middleware.html">Middleware</a> preProcessors will always have access to all params pre-scrubbing.</li>
					<li><code>matchExtensionMimeType</code> is currently only used by the <code>web</code> server, and it indicates that if this action is successfully called by a client with <code>connection.extension</code> set, the headers of the response should be changed to match that file type.  This is useful when creating actions that download files.</li>
					<li>ActionHero strives to keep the <code>data.connection</code> object uniform among various client types, and more importantly, present <code>data.params</code> in a homogeneous way to actions.  You can inspect <code>data.connection.type</code> to learn more about the connection.  The gory details of the connection (which vary on its type) are stored in <code>data.connection.rawConnection</code> which will contain the websocket, tcp connection, etc.  For web clients, <code>{</code>data.connection.rawConnection = {req: req, res: res}<code>}</code> for example.</li>
				</ul>
				<p><a href="tutorial-web-server.html">You can learn more about handling HTTP verbs and file uploads here</a> and <a href="tutorial-socket-server.html">TCP Clients</a> and <a href="tutorial-websocket-server.html">Web-Socket Clients</a>.</p>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class="globals  ">
						<a href="../../globals.html"><em>Globals</em></a>
					</li>
					<li class="current ">
						<a href="../index.html">Tutorial index</a>
						<ul>
							<li class="current ">
								<a href="index.html">Actionhero <wbr>Core <wbr>Features</a>
								<ul>
									<li class="current ">
										<a href="actions.html">Actions</a>
									</li>
									<li class=" ">
										<a href="tasks.html">Tasks</a>
									</li>
									<li class=" ">
										<a href="initializers.html">Initializers</a>
									</li>
									<li class=" ">
										<a href="localization.html">Localization</a>
									</li>
									<li class=" ">
										<a href="middleware.html">Middleware</a>
									</li>
									<li class=" ">
										<a href="testing.html">Testing</a>
									</li>
									<li class=" ">
										<a href="chat.html">Chat</a>
									</li>
									<li class=" ">
										<a href="servers/index.html">Servers</a>
									</li>
									<li class=" ">
										<a href="cli.html">Cli</a>
									</li>
								</ul>
							</li>
							<li class=" ">
								<a href="../config-and-dev/index.html">Configuration and <wbr>Development</a>
							</li>
							<li class=" ">
								<a href="../advanced/index.html">Advanced <wbr>Actionhero <wbr>Topics</a>
							</li>
						</ul>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer class="with-border-bottom">
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-module"><span class="tsd-kind-icon">Module</span></li>
				<li class="tsd-kind-object-literal"><span class="tsd-kind-icon">Object literal</span></li>
				<li class="tsd-kind-variable"><span class="tsd-kind-icon">Variable</span></li>
				<li class="tsd-kind-function"><span class="tsd-kind-icon">Function</span></li>
				<li class="tsd-kind-function tsd-has-type-parameter"><span class="tsd-kind-icon">Function with type parameter</span></li>
				<li class="tsd-kind-index-signature"><span class="tsd-kind-icon">Index signature</span></li>
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
				<li class="tsd-kind-type-alias tsd-has-type-parameter"><span class="tsd-kind-icon">Type alias with type parameter</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
				<li class="tsd-kind-enum-member"><span class="tsd-kind-icon">Enumeration member</span></li>
				<li class="tsd-kind-property tsd-parent-kind-enum"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-enum"><span class="tsd-kind-icon">Method</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
				<li class="tsd-kind-interface tsd-has-type-parameter"><span class="tsd-kind-icon">Interface with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-interface"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-interface"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-interface"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-interface"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
				<li class="tsd-kind-class tsd-has-type-parameter"><span class="tsd-kind-icon">Class with type parameter</span></li>
				<li class="tsd-kind-constructor tsd-parent-kind-class"><span class="tsd-kind-icon">Constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class"><span class="tsd-kind-icon">Property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class"><span class="tsd-kind-icon">Method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class"><span class="tsd-kind-icon">Accessor</span></li>
				<li class="tsd-kind-index-signature tsd-parent-kind-class"><span class="tsd-kind-icon">Index signature</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-constructor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited constructor</span></li>
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-inherited"><span class="tsd-kind-icon">Inherited accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-protected"><span class="tsd-kind-icon">Protected accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private property</span></li>
				<li class="tsd-kind-method tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private method</span></li>
				<li class="tsd-kind-accessor tsd-parent-kind-class tsd-is-private"><span class="tsd-kind-icon">Private accessor</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-property tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static property</span></li>
				<li class="tsd-kind-call-signature tsd-parent-kind-class tsd-is-static"><span class="tsd-kind-icon">Static method</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="container tsd-generator">
	<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p>
</div>
<div class="overlay"></div>
<script src="../../assets/js/main.js"></script>
<script>if (location.protocol == 'file:') document.write('<script src="../../assets/js/search.js"><' + '/script>');</script>
</body>
</html>